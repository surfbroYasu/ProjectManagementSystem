<th:block th:fragment="dbInfoAccordion">
	<div class="accordion my-5" id="dbAccordion_db">
		<th:block th:each="db, stat : ${dbList}">
			<div class="accordion-item">
				<h2 class="accordion-header" th:attr="id='heading' + ${stat.index}">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
						th:attr="data-bs-target='#collapse' + ${stat.index}" aria-expanded="false"
						th:attrappend="aria-controls='collapse' + ${stat.index}">

						<div class="d-flex flex-column">
							<strong th:text="${db.dbName}">データベース名</strong>
							<small class="text-muted" th:text="${db.dbms}">DBMS</small>
						</div>

					</button>
				</h2>
				<div class="accordion-collapse collapse" ... th:attr="id='collapse' + ${stat.index}"
					th:attrappend="aria-labelledby='heading' + ${stat.index}" data-bs-parent="#dbAccordion_db">
					<div class="accordion-body">

						<a th:href="@{/database/detail/{id}(id=${db.id})}" class="btn btn-outline-secondary btn-sm">
							データベース詳細
						</a>

						<a th:href="@{/modules/{id}(id=${project.id})}" class="btn btn-outline-secondary btn-sm">
							モジュール
						</a>

						<a th:href="@{/requirements/{id}(id=${project.id})}" class="btn btn-outline-secondary btn-sm">
							要件定義
						</a>

						<a th:href="@{/requirements/{id}(id=${project.id})}" class="btn btn-outline-secondary btn-sm">
							テーブル定義書
						</a>

						<!--クイック-->
						<hr />
						<p><strong>DBMS：</strong> <span th:text="${db.dbms}">MySQL</span></p>

						<th:block th:insert="~{contents/databases/fragments/register :: TableRegisterForm}"></th:block>


						<div class="row g-3 mt-2">
							<div class="col-md-6" th:each="table : ${tableInfoMap[db.id]}">
								<th:block th:insert="~{contents/databases/fragments/cards :: tableCard}"></th:block>
							</div>
						</div>

					</div>
				</div>
			</div>
		</th:block>
	</div>
</th:block>

<th:block th:fragment="tableInfoAccordion">
	<div class="accordion" id="dbAccordion_table">
		<th:block th:each="table : ${tableList}">
			<div class="accordion-item">
				<h2 class="accordion-header" th:id="'heading' + ${table.id}">
					<button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
						th:data-bs-target="'#collapse' + ${table.id}" aria-expanded="false"
						th:aria-controls="'collapse' + ${table.id}">
						<span th:text="${table.tableName} + '（' + ${table.tableAlias} + '）'"></span>
					</button>
				</h2>
				<div th:id="'collapse' + ${table.id}" class="accordion-collapse collapse"
					th:aria-labelledby="'heading' + ${table.id}" data-bs-parent="#dbAccordion_table">
					<div class="accordion-body">

						<a th:href="@{/database/table/{id}(id=${table.id})}" class="btn btn-outline-secondary btn-sm">
							テーブル詳細
						</a>

						<a th:href="@{/requirements/{id}(id=${project.id})}" class="btn btn-outline-secondary btn-sm">
							テーブル定義書
						</a>

						<hr />

						<table class="table table-striped table-bordered table-sm">
							<thead class="table-info">
								<tr>
									<th>カラム名</th>
									<th>論理名</th>
									<th>データ型</th>
									<th>PK</th>
									<th>FK</th>
								</tr>
							</thead>
							<tbody th:if="${columnMap[table.id] != null}">
								<tr th:each="col : ${columnMap[table.id]}">
									<td th:text="${col.columnName}">column</td>
									<td th:text="${col.alias}">alias</td>
									<td
										th:text="${col.dataType + (col.dataTypeParam != null ? '(' + col.dataTypeParam + ')' : '')}">
										type</td>

									<td th:text="${col.isPk ? '○' : ''}">pk</td>
									<td th:text="${col.isFK ? '○' : ''}">fk</td>
								</tr>
							</tbody>
						</table>

						<!--クイック-->
						<hr />
						<div class="bg-light p-3">
							<button type="button" class="btn btn-primary mb-3" th:id="'toggleBtn' + ${table.id}"
								th:onclick="'toggleForm(' + ${table.id} + ')'">
								カラム追加
							</button>

							<div th:id="'form' + ${table.id}" style="display: none;">
								<th:block th:insert="~{contents/databases/fragments/register :: ColumnRegisterForm}">
								</th:block>
							</div>
						</div>


					</div>
				</div>
			</div>
		</th:block>
	</div>
</th:block>